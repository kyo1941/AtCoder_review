name: Create Folder on New Branch

on:
  create:

jobs:
  create_folder:
    if: github.event.ref_type == 'branch'
    runs-on: ubuntu-latest
    permissions:
      contents: write

    steps:
      - name: Checkout new branch
        uses: actions/checkout@v4
        with:
          ref: ${{ github.ref }}

      - name: Create folder and README
        run: |
          FOLDER_NAME="${{ github.ref_name }}"
          mkdir -p "$FOLDER_NAME"
          README_PATH="$FOLDER_NAME/README.md"
          printf "## A - []()\n\n- "
          echo "Created folder: $FOLDER_NAME"
      - name: Commit and push changes
        run: |
          git config --global user.name 'github-actions[bot]'
          git config --global user.email 'github-actions[bot]@users.noreply.github.com'

          echo "--- Current Directory ---"
          pwd
          echo "--- Listing Root Directory ---"
          ls -la
          echo "--- Listing Created Folder ($FOLDER_NAME) ---"
          ls -la "$FOLDER_NAME"
          echo "--- Git Status Before Add ---"
          git status -s


          git add .

          echo "--- Git Status After Add ---"
          git status -s


          if ! git diff-index --quiet HEAD; then
            git commit -m "[Auto] Create Folder: ${{ github.ref_name }}"
            git push origin ${{ github.ref }}
          else
            echo "No changes to commit."
          fi